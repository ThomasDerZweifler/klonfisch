<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="Docutils 0.8.1: http://docutils.sourceforge.net/" />
<title>Klonfisch, the FishEye simulator for Gitorious</title>
<style type="text/css">

/*
:Author: David Goodger (goodger@python.org)
:Id: $Id: html4css1.css 7056 2011-06-17 10:50:48Z milde $
:Copyright: This stylesheet has been placed in the public domain.

Default cascading style sheet for the HTML output of Docutils.

See http://docutils.sf.net/docs/howto/html-stylesheets.html for how to
customize this style sheet.
*/

/* used to remove borders from tables and images */
.borderless, table.borderless td, table.borderless th {
  border: 0 }

table.borderless td, table.borderless th {
  /* Override padding for "table.docutils td" with "! important".
     The right padding separates the table cells. */
  padding: 0 0.5em 0 0 ! important }

.first {
  /* Override more specific margin styles with "! important". */
  margin-top: 0 ! important }

.last, .with-subtitle {
  margin-bottom: 0 ! important }

.hidden {
  display: none }

a.toc-backref {
  text-decoration: none ;
  color: black }

blockquote.epigraph {
  margin: 2em 5em ; }

dl.docutils dd {
  margin-bottom: 0.5em }

object[type="image/svg+xml"], object[type="application/x-shockwave-flash"] {
  overflow: hidden;
}

/* Uncomment (and remove this text!) to get bold-faced definition list terms
dl.docutils dt {
  font-weight: bold }
*/

div.abstract {
  margin: 2em 5em }

div.abstract p.topic-title {
  font-weight: bold ;
  text-align: center }

div.admonition, div.attention, div.caution, div.danger, div.error,
div.hint, div.important, div.note, div.tip, div.warning {
  margin: 2em ;
  border: medium outset ;
  padding: 1em }

div.admonition p.admonition-title, div.hint p.admonition-title,
div.important p.admonition-title, div.note p.admonition-title,
div.tip p.admonition-title {
  font-weight: bold ;
  font-family: sans-serif }

div.attention p.admonition-title, div.caution p.admonition-title,
div.danger p.admonition-title, div.error p.admonition-title,
div.warning p.admonition-title {
  color: red ;
  font-weight: bold ;
  font-family: sans-serif }

/* Uncomment (and remove this text!) to get reduced vertical space in
   compound paragraphs.
div.compound .compound-first, div.compound .compound-middle {
  margin-bottom: 0.5em }

div.compound .compound-last, div.compound .compound-middle {
  margin-top: 0.5em }
*/

div.dedication {
  margin: 2em 5em ;
  text-align: center ;
  font-style: italic }

div.dedication p.topic-title {
  font-weight: bold ;
  font-style: normal }

div.figure {
  margin-left: 2em ;
  margin-right: 2em }

div.footer, div.header {
  clear: both;
  font-size: smaller }

div.line-block {
  display: block ;
  margin-top: 1em ;
  margin-bottom: 1em }

div.line-block div.line-block {
  margin-top: 0 ;
  margin-bottom: 0 ;
  margin-left: 1.5em }

div.sidebar {
  margin: 0 0 0.5em 1em ;
  border: medium outset ;
  padding: 1em ;
  background-color: #ffffee ;
  width: 40% ;
  float: right ;
  clear: right }

div.sidebar p.rubric {
  font-family: sans-serif ;
  font-size: medium }

div.system-messages {
  margin: 5em }

div.system-messages h1 {
  color: red }

div.system-message {
  border: medium outset ;
  padding: 1em }

div.system-message p.system-message-title {
  color: red ;
  font-weight: bold }

div.topic {
  margin: 2em }

h1.section-subtitle, h2.section-subtitle, h3.section-subtitle,
h4.section-subtitle, h5.section-subtitle, h6.section-subtitle {
  margin-top: 0.4em }

h1.title {
  text-align: center }

h2.subtitle {
  text-align: center }

hr.docutils {
  width: 75% }

img.align-left, .figure.align-left, object.align-left {
  clear: left ;
  float: left ;
  margin-right: 1em }

img.align-right, .figure.align-right, object.align-right {
  clear: right ;
  float: right ;
  margin-left: 1em }

img.align-center, .figure.align-center, object.align-center {
  display: block;
  margin-left: auto;
  margin-right: auto;
}

.align-left {
  text-align: left }

.align-center {
  clear: both ;
  text-align: center }

.align-right {
  text-align: right }

/* reset inner alignment in figures */
div.align-right {
  text-align: inherit }

/* div.align-center * { */
/*   text-align: left } */

ol.simple, ul.simple {
  margin-bottom: 1em }

ol.arabic {
  list-style: decimal }

ol.loweralpha {
  list-style: lower-alpha }

ol.upperalpha {
  list-style: upper-alpha }

ol.lowerroman {
  list-style: lower-roman }

ol.upperroman {
  list-style: upper-roman }

p.attribution {
  text-align: right ;
  margin-left: 50% }

p.caption {
  font-style: italic }

p.credits {
  font-style: italic ;
  font-size: smaller }

p.label {
  white-space: nowrap }

p.rubric {
  font-weight: bold ;
  font-size: larger ;
  color: maroon ;
  text-align: center }

p.sidebar-title {
  font-family: sans-serif ;
  font-weight: bold ;
  font-size: larger }

p.sidebar-subtitle {
  font-family: sans-serif ;
  font-weight: bold }

p.topic-title {
  font-weight: bold }

pre.address {
  margin-bottom: 0 ;
  margin-top: 0 ;
  font: inherit }

pre.literal-block, pre.doctest-block, pre.math {
  margin-left: 2em ;
  margin-right: 2em }

span.classifier {
  font-family: sans-serif ;
  font-style: oblique }

span.classifier-delimiter {
  font-family: sans-serif ;
  font-weight: bold }

span.interpreted {
  font-family: sans-serif }

span.option {
  white-space: nowrap }

span.pre {
  white-space: pre }

span.problematic {
  color: red }

span.section-subtitle {
  /* font-size relative to parent (h1..h6 element) */
  font-size: 80% }

table.citation {
  border-left: solid 1px gray;
  margin-left: 1px }

table.docinfo {
  margin: 2em 4em }

table.docutils {
  margin-top: 0.5em ;
  margin-bottom: 0.5em }

table.footnote {
  border-left: solid 1px black;
  margin-left: 1px }

table.docutils td, table.docutils th,
table.docinfo td, table.docinfo th {
  padding-left: 0.5em ;
  padding-right: 0.5em ;
  vertical-align: top }

table.docutils th.field-name, table.docinfo th.docinfo-name {
  font-weight: bold ;
  text-align: left ;
  white-space: nowrap ;
  padding-left: 0 }

h1 tt.docutils, h2 tt.docutils, h3 tt.docutils,
h4 tt.docutils, h5 tt.docutils, h6 tt.docutils {
  font-size: 100% }

ul.auto-toc {
  list-style-type: none }

</style>
</head>
<body>
<div class="document" id="klonfisch-the-fisheye-simulator-for-gitorious">
<h1 class="title">Klonfisch, the FishEye simulator for Gitorious</h1>

<p>Implements the Atlassian <a class="reference external" href="http://atlassian.com/software/fisheye/">FishEye</a> API for <a class="reference external" href="https://gitorious.org/gitorious">Gitorious</a>, so that
you can view Gitorious Commits in <a class="reference external" href="http://atlassian.com/software/jira/">Jira</a>.</p>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#features" id="id7">Features</a><ul>
<li><a class="reference internal" href="#missing-features" id="id8">Missing features</a></li>
</ul>
</li>
<li><a class="reference internal" href="#screenshots" id="id9">Screenshots</a></li>
<li><a class="reference internal" href="#how-it-works" id="id10">How it works</a></li>
<li><a class="reference internal" href="#dependencies" id="id11">Dependencies</a></li>
<li><a class="reference internal" href="#setup" id="id12">Setup</a><ul>
<li><a class="reference internal" href="#klonfisch-setup" id="id13">Klonfisch setup</a></li>
<li><a class="reference internal" href="#gitorious-setup" id="id14">Gitorious setup</a></li>
<li><a class="reference internal" href="#jira-setup" id="id15">Jira setup</a></li>
</ul>
</li>
<li><a class="reference internal" href="#known-issues" id="id16">Known issues</a><ul>
<li><a class="reference internal" href="#clicking-on-repository-links-does-not-work" id="id17">Clicking on repository links does not work</a></li>
<li><a class="reference internal" href="#removing-application-links" id="id18">Removing application links</a></li>
<li><a class="reference internal" href="#crucible-links-buttons-in-jira" id="id19">Crucible links + buttons in Jira</a></li>
</ul>
</li>
<li><a class="reference internal" href="#about-klonfisch" id="id20">About Klonfisch</a><ul>
<li><a class="reference internal" href="#license" id="id21">License</a></li>
<li><a class="reference internal" href="#author" id="id22">Author</a></li>
<li><a class="reference internal" href="#homepage" id="id23">Homepage</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="features">
<h1><a class="toc-backref" href="#id7">Features</a></h1>
<ul class="simple">
<li>Simulates a part of the FishEye API</li>
<li>Works with the Jira FishEye plugin 5.0.7</li>
<li>Shows commits on issues (Tab &quot;Source&quot;)</li>
<li>Shows commits for projects (Tab &quot;Source&quot;)</li>
</ul>
<div class="section" id="missing-features">
<h2><a class="toc-backref" href="#id8">Missing features</a></h2>
<ul class="simple">
<li>Showing files that got changed in a commit. Waiting for
<a class="reference external" href="https://issues.gitorious.org/issues/128">issue #128</a></li>
<li>Project statistics</li>
<li>Authentication - everyone can see all commits</li>
<li>Activity streams</li>
</ul>
</div>
</div>
<div class="section" id="screenshots">
<h1><a class="toc-backref" href="#id9">Screenshots</a></h1>
<div class="figure">
<a class="reference external image-reference" href="doc/issue-source.png"><img alt="doc/issue-source.png" src="doc/issue-source.png" style="height: 200px;" /></a>
<p class="caption">Jira's issue source tab</p>
</div>
<div class="figure">
<a class="reference external image-reference" href="doc/project-source.png"><img alt="doc/project-source.png" src="doc/project-source.png" style="height: 200px;" /></a>
<p class="caption">Jira's project source tab</p>
</div>
</div>
<div class="section" id="how-it-works">
<h1><a class="toc-backref" href="#id10">How it works</a></h1>
<p>Klonfish is a PHP application that sits between Jira and Gitorious:</p>
<p>Gitorious sends commit information to Klonfisch which stores them
in a MySQL database.
This is done via &quot;web hooks&quot;.</p>
<p>Jira on the other hand talks to Klonfisch, asking for commit information
for projects or single issues.
Klonfisch searches in the commit database and returns them to Jira.
Jira then displays the commits in the &quot;Source&quot; tab of issues and projects.</p>
<p>You just have to install the FishEye plugin for Jira, which takes care of
talking to Klonfisch and the commit visualization.</p>
</div>
<div class="section" id="dependencies">
<h1><a class="toc-backref" href="#id11">Dependencies</a></h1>
<ul class="simple">
<li>PHP 5.3+</li>
<li>Apache with <tt class="docutils literal">mod_rewrite</tt> enabled</li>
<li>MySQL (or any other database supported by PDO)</li>
</ul>
</div>
<div class="section" id="setup">
<h1><a class="toc-backref" href="#id12">Setup</a></h1>
<div class="section" id="klonfisch-setup">
<h2><a class="toc-backref" href="#id13">Klonfisch setup</a></h2>
<ol class="arabic simple">
<li><tt class="docutils literal">git clone</tt> the klonfisch git repository</li>
<li>Create a (MySQL) database to store the commits in</li>
<li>Import <tt class="docutils literal">data/database.sql</tt> into that database</li>
<li>Copy <tt class="docutils literal">data/klonfisch.config.php.dist</tt> to
<tt class="docutils literal">data/klonfisch.config.php</tt> and adjust it to your environment.</li>
<li>Setup your (apache) webserver by adding a virtual host and pointing its
document root to <tt class="docutils literal">$klonfisch/www/</tt></li>
</ol>
</div>
<div class="section" id="gitorious-setup">
<h2><a class="toc-backref" href="#id14">Gitorious setup</a></h2>
<p>Klonfisch keeps record of commits to your Gitorious instance via web hooks.
You can setup them manually in the database, or let Klonfisch create the
hooks automatically.</p>
<p>Run <tt class="docutils literal"><span class="pre">scripts/update-gitorious-hooks.php</span></tt> ever hour to automatically
register the hook for newly created repositories.</p>
<p>Gitorious will then call <tt class="docutils literal"><span class="pre">/webhook-call.php</span></tt> for each single commit
to a repository.</p>
</div>
<div class="section" id="jira-setup">
<h2><a class="toc-backref" href="#id15">Jira setup</a></h2>
<ol class="arabic simple">
<li>Install the FishEye plugin. Just installation, no configuration</li>
<li>Go to Administration / Plugins / Application Links</li>
<li>Click &quot;Add Application Link&quot;</li>
<li>Set the Server URL, e.g. <tt class="docutils literal"><span class="pre">http://klonfisch.gitorious.company.com/</span></tt></li>
<li>Disable <tt class="docutils literal">Also create a link from &quot;klonfisch&quot; back to to this server</tt></li>
<li>Finish the application link setup</li>
</ol>
<p>That's it. You do not need to setup any authentication.
You do not need to setup any project connections.</p>
<p>Now do a commit, mentioning the issue number (e.g. &quot;JGA-11&quot;) in the commit
message.
You will see the commit in Jira's &quot;Source&quot; tab.</p>
</div>
</div>
<div class="section" id="known-issues">
<h1><a class="toc-backref" href="#id16">Known issues</a></h1>
<p>Also see <a class="reference internal" href="#missing-features">Missing features</a>.</p>
<div class="section" id="clicking-on-repository-links-does-not-work">
<h2><a class="toc-backref" href="#id17">Clicking on repository links does not work</a></h2>
<p>Klonfisch simulates only one git repository, mainly to reduce the number
of requests from Jira.
(helpful if you have 700+ repositories, and 200+ repositories for a single
Jira project)
This leads to the issue that only the repository &quot;test&quot; is shown for
the commits, even though they are from a different repository.</p>
<p>Use the branch link instead (<tt class="docutils literal">master in <span class="pre">$project/$repo</span></tt>).</p>
</div>
<div class="section" id="removing-application-links">
<h2><a class="toc-backref" href="#id18">Removing application links</a></h2>
<p>After removing an application link, you need to disable the
FishEye plugin and re-enable it again.</p>
<p>If you fail to do so, you will see errors like</p>
<blockquote>
<p>This list may be incomplete, as errors occurred whilst retrieving
source from linked applications:</p>
<p>Repository test on <a class="reference external" href="http://klonfisch.gitorious.nr/">http://klonfisch.gitorious.nr/</a> failed:
The application link with id '46bc9c7c-0bad-3503-9ddf-0123456789ab'
was not found for instance 'FishEyeInstanceImpl...'</p>
</blockquote>
</div>
<div class="section" id="crucible-links-buttons-in-jira">
<h2><a class="toc-backref" href="#id19">Crucible links + buttons in Jira</a></h2>
<p>You will see &quot;Create Crucible reviews&quot; links in Jira's issue tab.</p>
<p>I have no idea how to deactivate them.
If you know how, tell me.</p>
</div>
</div>
<div class="section" id="about-klonfisch">
<h1><a class="toc-backref" href="#id20">About Klonfisch</a></h1>
<div class="section" id="license">
<h2><a class="toc-backref" href="#id21">License</a></h2>
<p>Klonfisch is licensed under the <a class="reference external" href="http://www.gnu.org/licenses/agpl">AGPL v3</a> or later.</p>
</div>
<div class="section" id="author">
<h2><a class="toc-backref" href="#id22">Author</a></h2>
<p>Christian Weiske, <a class="reference external" href="http://www.netresearch.de/">Netresearch GmbH &amp; Co KG</a></p>
</div>
<div class="section" id="homepage">
<h2><a class="toc-backref" href="#id23">Homepage</a></h2>
<p>Klonfisch is available at <a class="reference external" href="https://github.com/netresearch/klonfisch">https://github.com/netresearch/klonfisch</a></p>
</div>
</div>
</div>
</body>
</html>
