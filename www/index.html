<!DOCTYPE html>
<html>
 <head>
  <title>Klonfisch</title>
  <link rel="shortcut icon" href="favicon.ico"/>
 </head>
 <body>
  <p>
    Hi. This is Klonfisch, the FishEye API simulator for Gitorious.
  </p>


  <h2>Features</h2>
  <ul>
   <li>Simulates a part of the FishEye API</li>
   <li>Works with the Jira FishEye plugin 5.0.7</li>
   <li>Shows commits on issues (Tab "Source")</li>
   <li>Shows commits for projects (Tab "Source")</li>
  </ul>

  <h2>Basic setup</h2>
  <ul>
   <li><tt>git clone</tt> the klonfisch repository</li>
   <li>Create a database to store the commits in</li>
   <li>Import <tt>data/database.sql</tt> into that database</li>
   <li>
     Copy <tt>data/klonfisch.config.php.dist</tt> to
     <tt>data/klonfisch.config.php</tt> and adjust it to your environment.
   </li>
  </ul>


  <h2>Gitorious setup</h2>
  <p>
   Klonfisch keeps record of commits to your Gitorious instance via
   web hooks.
   You can setup them manually in the database, or let Klonfisch create
   the hooks automatically.
  </p>
  <p>
   Run <tt>scripts/update-gitorious-hooks.php</tt> ever hour to automatically
   register the hook for new repositories.
  </p>


  <h2>Jira setup</h2>
  <ul>
   <li>Install the FishEye plugin. Just installation, no configuration</li>
   <li>Go to Administration / Plugins / Application Links</li>
   <li>Click "Add Application Link"</li>
   <li>Set the Server URL, e.g. http://klonfisch.gitorious.company.com/</li>
   <li>
     Disable <tt>Also create a link from "klonfisch" back to to this server</tt>
   </li>
   <li>Finish the application link setup</li>
   <li>That's it. You do not need to setup any authentication</li>
  </ul>


  <h2>Known issues</h2>
  <ul>
   <li>
    <p>
     After removing an application link, you need to disable the
     FishEye plugin and re-enable it again.
    </p>
    <p>
     If you fail to do so, you will see errors like
    </p>
    <blockquote>
     This list may be incomplete, as errors occurred whilst retrieving
     source from linked applications:<br/>
     Repository test on http://klonfisch.gitorious.nr/ failed:
     The application link with id '46bc9c7c-0bad-3503-9ddf-0123456789ab'
     was not found for instance 'FishEyeInstanceImpl...'
    </blockquote>
   </li>
  </ul>
 </body>
</html>
